<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Monitoring Windows Endpoints with Winlogbeat | ThinkBox</title>
        <meta name="Description" content=""><meta property="og:title" content="Monitoring Windows Endpoints with Winlogbeat" />
<meta property="og:description" content="Introduction This post will introduce the steps needed in order to setup a Windows endpoint to forward logs to Logstash. The following diagram shows a layout of how all the components will interact with each other.
On the Endpoint we have logs that we want to ship to Elasticsearch, these logs include various system logs generated by Windows and Sysmon logs. The Sysmon logs are generated by another program installed on the system which will monitor events related to processes being created and registry values being changed." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.thinkbox.dev/posts/0013-monitor-windows-endpoint/" />
<meta property="article:published_time" content="2020-01-20T22:32:25-04:00" />
<meta property="article:modified_time" content="2020-01-20T22:32:25-04:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Monitoring Windows Endpoints with Winlogbeat"/>
<meta name="twitter:description" content="Introduction This post will introduce the steps needed in order to setup a Windows endpoint to forward logs to Logstash. The following diagram shows a layout of how all the components will interact with each other.
On the Endpoint we have logs that we want to ship to Elasticsearch, these logs include various system logs generated by Windows and Sysmon logs. The Sysmon logs are generated by another program installed on the system which will monitor events related to processes being created and registry values being changed."/>
<meta name="theme-color" content="#ffffff">
<meta name="msapplication-TileColor" content="#da532c">
<link rel="canonical" href="https://blog.thinkbox.dev/posts/0013-monitor-windows-endpoint/" />
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="prev" href="https://blog.thinkbox.dev/posts/0012-configure-single-elk-node/" /><link rel="next" href="https://blog.thinkbox.dev/posts/0014-setting-up-wazuh/" /><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><link rel="stylesheet" href="/css/style.min.css"><meta name="google-site-verification" content="UA-161605270-1" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Monitoring Windows Endpoints with Winlogbeat",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.thinkbox.dev\/posts\/0013-monitor-windows-endpoint\/"
        },"genre": "posts","keywords": "ELK","wordcount":  1733 ,
        "url": "https:\/\/blog.thinkbox.dev\/posts\/0013-monitor-windows-endpoint\/","datePublished": "2020-01-20","dateModified": "2020-01-20","author": {
                "@type": "Person",
                "name": "Aleks"
            },"description": ""
    }
    </script></head>
    <body><script>
            if (!window.localStorage || !window.localStorage.getItem('theme')) {window.isDark = 'dark' === 'dark';} else {
                window.isDark = (window.localStorage && window.localStorage.getItem('theme')) === 'dark';
            }
            window.isDark && document.body.classList.add('dark-theme');
        </script><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/">ThinkBox</a>
        </div>
        <div class="menu"><a class="menu-item" href="/posts/" rel="noopener noreffer">Posts</a><a class="menu-item" href="/tags/" rel="noopener noreffer">Tags</a><a class="menu-item" href="/categories/" rel="noopener noreffer">Categories</a><span class="menu-item">|</span>
            <a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-wrapper">
        <div class="header-container">
            <div class="header-title">
                <a href="/">ThinkBox</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="" rel="noopener noreffer">Posts</a><a class="menu-item" href="/tags/" title="" rel="noopener noreffer">Tags</a><a class="menu-item" href="/categories/" title="" rel="noopener noreffer">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>

<script>
    window.desktopHeaderMode = "fixed";
    window.mobileHeaderMode = "auto";
</script>
<main class="main">
                <div class="container"><article class="page single"><h1 class="single-title animated flipInX">Monitoring Windows Endpoints with Winlogbeat</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Aleks</a>
</span>&nbsp;
                    <span class="post-category">included in<a href="/categories/information-security">
                                <i class="far fa-folder fa-fw"></i>Information security
                            </a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i><time datetime=2020-01-20>2020-01-20</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>about 1733 words&nbsp;
                <i class="far fa-clock fa-fw"></i>9 min&nbsp;</div>
        </div><div class="toc" id="toc-auto">
                <h2 class="toc-title">Contents</h2>
                <div class="toc-content" id="toc-content-auto"></div>
            </div>
            <div class="toc" id="toc-static">
                <details>
                    <summary>
                        <div class="toc-title">
                            <span>Contents</span>
                            <span><i class="details icon fas fa-angle-down"></i></span>
                        </div>
                    </summary>
                    <div class="toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#configuring-logging-locally">Configuring Logging Locally</a></li>
    <li><a href="#enhanced-powershell-logging">Enhanced PowerShell Logging</a>
      <ul>
        <li><a href="#turn-on-module-logging">Turn on Module Logging</a></li>
        <li><a href="#turn-on-powershell-script-block-logging">Turn on PowerShell Script Block Logging</a></li>
        <li><a href="#turn-on-powershell-transcription">Turn on PowerShell Transcription</a></li>
      </ul>
    </li>
    <li><a href="#setting-up-logstash">Setting Up Logstash</a>
      <ul>
        <li><a href="#alternative-copying-helk">Alternative: Copying HELK</a></li>
      </ul>
    </li>
    <li><a href="#shipping-logs-with-winlogbeat">Shipping Logs with WinlogBeat</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
                </details>
            </div><div class="content" id="content" style="text-align: justify;"><h2 id="introduction">Introduction</h2>
<p>This post will introduce the steps needed in order to setup a Windows endpoint to forward logs to Logstash. The following diagram shows a layout of how all the components will interact with each other.</p>
<p><img
        class="lazyload"
        src="/svg/loading.small.min.svg"
        data-sizes="auto"
        data-srcset="/Pictures/0013-monitor-windows-endpoint/WinlogbeatDiagram.png,  1.5x,  2x"
        data-src=""
        alt=""
        title="" /></p>
<p>On the Endpoint we have logs that we want to ship to Elasticsearch, these logs include various system logs generated by Windows and Sysmon logs. The Sysmon logs are generated by another program installed on the system which will monitor events related to processes being created and registry values being changed.</p>
<p>The logs stored on the system are read by another program we install called Winlogbeat, after it has read the log it will send the logs to Logstash. This is the main mechanism we use to get logs out of the endpoint onto the ELK Server.</p>
<p>After the logs are on the ELK Server Logstash is capable of performing actions on the logs. It can be as simple as take them and put them into Elasticsearch, or it can get more complicated and alter the format and fields of the logs. For example, if a log file includes IP addresses Logstash can attach a field related to which country and city the IP address is located in.</p>
<h2 id="configuring-logging-locally">Configuring Logging Locally</h2>
<p>Now that Elasticsearch, Logstash, and Kibana are configured and running the endpoint must be setup to forward logs. The endpoint system is a Windows Server 2019 computer that will be using Winlogbeat to forward logs to Logstash. Furthermore, Sysmon will be installed which will give a deeper insight into what is happening on the system.</p>
<p>The following links to software used:</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon" target="_blank" rel="noopener noreffer">Sysmon</a>
 – <a href="https://download.sysinternals.com/files/Sysmon.zip" target="_blank" rel="noopener noreffer">Download</a>
</li>
<li><a href="https://www.elastic.co/downloads/beats/winlogbeat" target="_blank" rel="noopener noreffer">Winlogbeat</a>
 – <a href="https://artifacts.elastic.co/downloads/beats/winlogbeat/winlogbeat-7.3.2-windows-x86_64.zip" target="_blank" rel="noopener noreffer">Download</a>
</li>
<li><a href="https://github.com/SwiftOnSecurity/sysmon-config" target="_blank" rel="noopener noreffer">SwiftOnSecurity Sysmon Configuration</a>
 – <a href="https://github.com/SwiftOnSecurity/sysmon-config/archive/master.zip" target="_blank" rel="noopener noreffer">Download</a>
</li>
</ul>
<p>Installing Sysmon</p>
<p>Sysmon is a a service that can be installed on Windows which will provide detailed information regarding processes, registry, and network connections. These logs are stored locally on the system and can be forwarded to a central logging server or SIEM.</p>
<p>In order to install and configure Sysmon make sure you have downloaded the official ZIP file and the SwiftOnSecurity Sysmon configuration. It is not mandatory to use this configuration file, or any configuration file for that matter as there are default settings. However, Sysmon can be configured in many different ways and the SwitftOnSecurity configuration is a decent starting point.</p>
<p>Make sure to extract the Sysmon.exe binary that will be used to install the service, also don’t forget to extract the SwiftOnSecurity Sysmon configuration file into the same location. Run the following command in order to install the service.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">PS </span><span class="n">C:</span><span class="p">\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrator</span><span class="p">\</span><span class="n">Downloads</span><span class="p">&gt;</span> <span class="p">.\</span><span class="n">Sysmon64</span><span class="p">.</span><span class="n">exe</span> <span class="n">-accepteula</span> <span class="n">-i</span> <span class="p">.\</span><span class="n">sysmonconfig-export</span><span class="p">.</span><span class="n">xml</span>

<span class="n">System</span> <span class="n">Monitor</span> <span class="n">v10</span><span class="p">.</span><span class="n">41</span> <span class="p">-</span> <span class="n">System</span> <span class="n">activity</span> <span class="n">monitor</span>
<span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="n">2014</span><span class="p">-</span><span class="n">2019</span> <span class="n">Mark</span> <span class="n">Russinovich</span> <span class="n">and</span> <span class="n">Thomas</span> <span class="n">Garnier</span>
<span class="n">Sysinternals</span> <span class="p">-</span> <span class="n">www</span><span class="p">.</span><span class="n">sysinternals</span><span class="p">.</span><span class="n">com</span>

<span class="n">Loading</span> <span class="n">configuration</span> <span class="n">file</span> <span class="n">with</span> <span class="n">schema</span> <span class="n">version</span> <span class="n">4</span><span class="p">.</span><span class="n">00</span>
<span class="n">Sysmon</span> <span class="n">schema</span> <span class="n">version</span><span class="err">:</span> <span class="n">4</span><span class="p">.</span><span class="n">22</span>
<span class="n">Configuration</span> <span class="n">file</span> <span class="n">validated</span><span class="p">.</span>
<span class="n">Sysmon64</span> <span class="n">installed</span><span class="p">.</span>
<span class="n">SysmonDrv</span> <span class="n">installed</span><span class="p">.</span>
<span class="n">Starting</span> <span class="n">SysmonDrv</span><span class="p">.</span>
<span class="n">SysmonDrv</span> <span class="n">started</span><span class="p">.</span>
<span class="n">Starting</span> <span class="n">Sysmon64</span><span class="p">..</span>
<span class="n">Sysmon64</span> <span class="n">started</span><span class="p">.</span>
</code></pre></td></tr></table>
</div>
</div><p>Now that Sysmon is installed you can check that the service is active and running.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="nb">Get-Service</span> <span class="n">-Name</span> <span class="n">Sysmon64</span>

<span class="n">Status</span>   <span class="n">Name</span>               <span class="n">DisplayName</span>
<span class="p">------</span>   <span class="p">----</span>               <span class="p">-----------</span>
<span class="n">Running</span>  <span class="n">Sysmon64</span>           <span class="n">Sysmon64</span>
</code></pre></td></tr></table>
</div>
</div><p>As said before the Sysmon logs are stored locally, this means that you can view the logs generated right away in Event Viewer. Below we can see a PowerShell command being used to view the logs.</p>
<p>The logs are generated in <strong>Microsoft/Windows/Sysmon</strong>. As can be seen the following shows a process create event for the powershell.exe binary. This provides us with a lot of information, we can see that the process that launched PowerShell was cmd.exe and that it was done by the Administrator. You can also see that it gives a hash of the binary that has been run, this can be taken to <a href="https://www.virustotal.com/" target="_blank" rel="noopener noreffer">VirusTotal</a>
 and scanned.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="nb">Get-WinEvent</span> <span class="n">-FilterHashtable</span> <span class="p">@{</span> <span class="n">LogName</span> <span class="p">=</span> <span class="s2">&#34;Microsoft-Windows-Sysmon/Operational&#34;</span> <span class="p">}</span> <span class="p">|</span> <span class="nb">Where-Object</span>  <span class="n">-FilterScript</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Id</span> <span class="o">-eq</span> <span class="n">1</span><span class="p">}</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-First</span> <span class="n">1</span> <span class="p">|</span> <span class="nb">Format-List</span>


<span class="n">TimeCreated</span>  <span class="err">:</span> <span class="n">11</span><span class="p">/</span><span class="n">22</span><span class="p">/</span><span class="n">2019</span> <span class="n">3</span><span class="err">:</span><span class="n">51</span><span class="err">:</span><span class="n">12</span> <span class="n">PM</span>
<span class="n">ProviderName</span> <span class="err">:</span> <span class="n">Microsoft-Windows-Sysmon</span>
<span class="n">Id</span>           <span class="err">:</span> <span class="n">1</span>
<span class="n">Message</span>      <span class="err">:</span> <span class="k">Process</span> <span class="n">Create</span><span class="err">:</span>
               <span class="n">RuleName</span><span class="err">:</span>
               <span class="n">UtcTime</span><span class="err">:</span> <span class="n">2019</span><span class="p">-</span><span class="n">11</span><span class="p">-</span><span class="n">22</span> <span class="n">23</span><span class="err">:</span><span class="n">51</span><span class="err">:</span><span class="n">12</span><span class="p">.</span><span class="n">995</span>
               <span class="n">ProcessGuid</span><span class="err">:</span> <span class="p">{</span><span class="n">3ca46963</span><span class="p">-</span><span class="n">7470</span><span class="p">-</span><span class="n">5dd8</span><span class="p">-</span><span class="n">0000</span><span class="p">-</span><span class="n">0010f9d43700</span><span class="p">}</span>
               <span class="n">ProcessId</span><span class="err">:</span> <span class="n">2244</span>
               <span class="n">Image</span><span class="err">:</span> <span class="n">C:</span><span class="p">\</span><span class="n">Windows</span><span class="p">\</span><span class="n">System32</span><span class="p">\</span><span class="n">WindowsPowerShell</span><span class="p">\</span><span class="n">v1</span><span class="p">.</span><span class="n">0</span><span class="p">\</span><span class="n">powershell</span><span class="p">.</span><span class="n">exe</span>
               <span class="n">FileVersion</span><span class="err">:</span> <span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">17763</span><span class="p">.</span><span class="n">1</span> <span class="p">(</span><span class="n">WinBuild</span><span class="p">.</span><span class="n">160101</span><span class="p">.</span><span class="n">0800</span><span class="p">)</span>
               <span class="n">Description</span><span class="err">:</span> <span class="n">Windows</span> <span class="n">PowerShell</span>
               <span class="n">Product</span><span class="err">:</span> <span class="n">Microsoft</span><span class="err">®</span> <span class="n">Windows</span><span class="err">®</span> <span class="n">Operating</span> <span class="n">System</span>
               <span class="n">Company</span><span class="err">:</span> <span class="n">Microsoft</span> <span class="n">Corporation</span>
               <span class="n">OriginalFileName</span><span class="err">:</span> <span class="n">PowerShell</span><span class="p">.</span><span class="n">EXE</span>
               <span class="n">CommandLine</span><span class="err">:</span> <span class="n">powershell</span><span class="p">.</span><span class="n">exe</span>
               <span class="n">CurrentDirectory</span><span class="err">:</span> <span class="n">C:</span><span class="p">\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrator</span><span class="p">\</span>
               <span class="n">User</span><span class="err">:</span> <span class="n">DC</span><span class="p">\</span><span class="n">Administrator</span>
               <span class="n">LogonGuid</span><span class="err">:</span> <span class="p">{</span><span class="n">3ca46963-e019</span><span class="p">-</span><span class="n">5dd8</span><span class="p">-</span><span class="n">0000</span><span class="p">-</span><span class="n">002066df0200</span><span class="p">}</span>
               <span class="n">LogonId</span><span class="err">:</span> <span class="n">0x2DF66</span>
               <span class="n">TerminalSessionId</span><span class="err">:</span> <span class="n">1</span>
               <span class="n">IntegrityLevel</span><span class="err">:</span> <span class="n">High</span>
               <span class="n">Hashes</span><span class="err">:</span> <span class="n">MD5</span><span class="p">=</span><span class="n">7353F60B1739074EB17C5F4DDDEFE239</span><span class="p">,</span><span class="n">SHA256</span><span class="p">=</span><span class="n">DE96A6E69944335375DC1AC238336066889D9FFC7D73628EF4FE1B1B160AB32C</span>
               <span class="n">ParentProcessGuid</span><span class="err">:</span> <span class="p">{</span><span class="n">3ca46963</span><span class="p">-</span><span class="n">746c</span><span class="p">-</span><span class="n">5dd8</span><span class="p">-</span><span class="n">0000</span><span class="p">-</span><span class="n">0010f3cc3700</span><span class="p">}</span>
               <span class="n">ParentProcessId</span><span class="err">:</span> <span class="n">1916</span>
               <span class="n">ParentImage</span><span class="err">:</span> <span class="n">C:</span><span class="p">\</span><span class="n">Windows</span><span class="p">\</span><span class="n">System32</span><span class="p">\</span><span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>
               <span class="n">ParentCommandLine</span><span class="err">:</span> <span class="s2">&#34;C:\Windows\system32\cmd.exe&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="enhanced-powershell-logging">Enhanced PowerShell Logging</h2>
<p>PowerShell logging has the ability to log what actions have been taken using PowerShell, these including logging commands run, saving the output of these commands, and also show the de-obfuscated versions of commands run.</p>
<p>One of the most important logs related to this is Even ID 4103, we can see an example below in the code snippet. From this we can figure out that the Administrator user has run Get-Process in PowerShell.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="nb">Get-WinEvent</span> <span class="n">-FilterHashtable</span> <span class="p">@{</span> <span class="n">LogName</span> <span class="p">=</span> <span class="s2">&#34;Microsoft-Windows-PowerShell/Operational&#34;</span><span class="p">}</span> <span class="p">|</span> <span class="nb">Where-Object</span>  <span class="n">-FilterScript</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Id</span> <span class="o">-eq</span> <span class="n">4103</span><span class="p">}</span> <span class="p">|</span><span class="nb">Select-Object</span> <span class="n">-First</span> <span class="n">1</span> <span class="p">|</span> <span class="nb">Format-List</span>

<span class="n">TimeCreated</span>  <span class="err">:</span> <span class="n">11</span><span class="p">/</span><span class="n">22</span><span class="p">/</span><span class="n">2019</span> <span class="n">5</span><span class="err">:</span><span class="n">42</span><span class="err">:</span><span class="n">13</span> <span class="n">PM</span>
<span class="n">ProviderName</span> <span class="err">:</span> <span class="n">Microsoft-Windows-PowerShell</span>
<span class="n">Id</span>           <span class="err">:</span> <span class="n">4103</span>
<span class="n">Message</span>      <span class="err">:</span> <span class="n">CommandInvocation</span><span class="p">(</span><span class="nb">Get-Process</span><span class="p">)</span><span class="err">:</span> <span class="s2">&#34;Get-Process&#34;</span>


               <span class="n">Context</span><span class="err">:</span>
                       <span class="n">Severity</span> <span class="p">=</span> <span class="n">Informational</span>
                       <span class="n">Host</span> <span class="n">Name</span> <span class="p">=</span> <span class="n">ConsoleHost</span>
                       <span class="n">Host</span> <span class="n">Version</span> <span class="p">=</span> <span class="n">5</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">17763</span><span class="p">.</span><span class="n">316</span>
                       <span class="n">Host</span> <span class="n">ID</span> <span class="p">=</span> <span class="n">1df2f188</span><span class="p">-</span><span class="n">5a35</span><span class="p">-</span><span class="n">4c23-a094</span><span class="p">-</span><span class="n">70b67cdeb9f0</span>
                       <span class="n">Host</span> <span class="n">Application</span> <span class="p">=</span> <span class="n">C:</span><span class="p">\</span><span class="n">Windows</span><span class="p">\</span><span class="n">system32</span><span class="p">\</span><span class="n">WindowsPowerShell</span><span class="p">\</span><span class="n">v1</span><span class="p">.</span><span class="n">0</span><span class="p">\</span><span class="n">PowerShell</span><span class="p">.</span><span class="n">exe</span>
                       <span class="n">Engine</span> <span class="n">Version</span> <span class="p">=</span> <span class="n">5</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">17763</span><span class="p">.</span><span class="n">316</span>
                       <span class="n">Runspace</span> <span class="n">ID</span> <span class="p">=</span> <span class="n">da3546f0-d7d1</span><span class="p">-</span><span class="n">472f</span><span class="p">-</span><span class="n">9721</span><span class="p">-</span><span class="n">0daea98de7bd</span>
                       <span class="n">Pipeline</span> <span class="n">ID</span> <span class="p">=</span> <span class="n">11</span>
                       <span class="n">Command</span> <span class="n">Name</span> <span class="p">=</span> <span class="nb">Get-Process</span>
                       <span class="n">Command</span> <span class="nb">Type </span><span class="p">=</span> <span class="n">Cmdlet</span>
                       <span class="n">Script</span> <span class="n">Name</span> <span class="p">=</span>
                       <span class="n">Command</span> <span class="n">Path</span> <span class="p">=</span>
                       <span class="n">Sequence</span> <span class="n">Number</span> <span class="p">=</span> <span class="n">26</span>
                       <span class="n">User</span> <span class="p">=</span> <span class="n">DC</span><span class="p">\</span><span class="n">Administrator</span>
                       <span class="n">Connected</span> <span class="n">User</span> <span class="p">=</span>
                       <span class="n">Shell</span> <span class="n">ID</span> <span class="p">=</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">PowerShell</span>
</code></pre></td></tr></table>
</div>
</div><p>In order to enable PowerShell logging we must turn on a few options in group polices. The options are located in <code>Administrative Templates -&gt; Windows Components -&gt; Windows PowerShell</code>. A screenshot below shows that we should have enabled three options, module logging, Script Block Logging, and Transcription. This image was found on a FireEye blog post related to this topic, I recommend checking it out for more information.</p>
<p><img
        class="lazyload"
        src="/svg/loading.small.min.svg"
        data-sizes="auto"
        data-srcset="https://www.fireeye.com/content/dam/fireeye-www/blog/images/dunwoody%20powershell/figure_2.png,  1.5x,  2x"
        data-src=""
        alt=""
        title="" /></p>
<p>The following shows a brief list of actions that are needed to be taken in order to enable each option:</p>
<h3 id="turn-on-module-logging">Turn on Module Logging</h3>
<p>Enable this option. Within the options click “Show” and enter a ‘*’ into the new Window. This will allow all PowerShell modules to be logged.</p>
<h3 id="turn-on-powershell-script-block-logging">Turn on PowerShell Script Block Logging</h3>
<p>All that needs to be done is to click Enable on this option.</p>
<h3 id="turn-on-powershell-transcription">Turn on PowerShell Transcription</h3>
<p>All that needs to be done is to click Enable on this option, unless a specific central location is desired for PowerShell transcripts.</p>
<h2 id="setting-up-logstash">Setting Up Logstash</h2>
<p>Logstash is where all the hidden power lies, from here it is possible to take logs and format them to your liking. This is a time consuming process, there are two interesting projects that have configuration files you can either copy or use for inspiration. These two projects are <a href="https://github.com/Cyb3rWard0g/HELK" target="_blank" rel="noopener noreffer">HELK</a>
 and <a href="https://github.com/philhagen/sof-elk" target="_blank" rel="noopener noreffer">SOF ELK</a>
.</p>
<p>The following Logstash configuration will take input from the Windows endpoint and put all the logs in a single index without filtering them. This may be enough for simple setup used for testing, but more advanced environments may need to change the format of logs to meet specific requirements.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">input <span class="o">{</span>
  beats <span class="o">{</span>
    <span class="nv">port</span> <span class="o">=</span>&gt; <span class="m">5044</span>
    <span class="nv">add_field</span> <span class="o">=</span>&gt; <span class="o">{</span><span class="s2">&#34;[@metadata][source]&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;winlogbeat&#34;</span><span class="o">}</span>
    <span class="nv">ssl</span> <span class="o">=</span>&gt; <span class="nb">false</span>
  <span class="o">}</span>
<span class="o">}</span>
output <span class="o">{</span>
	elasticsearch <span class="o">{</span>
		<span class="nv">hosts</span> <span class="o">=</span>&gt; <span class="o">[</span><span class="s2">&#34;http://10.0.0.10:9200&#34;</span><span class="o">]</span>
		<span class="nv">index</span> <span class="o">=</span>&gt; <span class="s2">&#34;%{[@metadata][beat]}-%{+YYYY.MM.dd}&#34;</span>
		<span class="nv">document_type</span> <span class="o">=</span>&gt; <span class="s2">&#34;%{[@metadata][type]}&#34;</span>
		<span class="nv">ssl</span> <span class="o">=</span>&gt; <span class="nb">false</span>
		<span class="nv">ssl_certificate_verification</span> <span class="o">=</span>&gt; <span class="nb">false</span>
		<span class="nv">sniffing</span> <span class="o">=</span>&gt; <span class="nb">true</span>
		<span class="nv">manage_template</span> <span class="o">=</span>&gt; <span class="nb">false</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>After this configuration file has been added restart Logstash and configure an endpoint to send logs in the next section.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>user@ELKNode<span class="o">]</span>$ sudo systemctl restart logstash
</code></pre></td></tr></table>
</div>
</div><h3 id="alternative-copying-helk">Alternative: Copying HELK</h3>
<p>As an alternative it is also possible to copy HELK’s configurations and use them in this instance. Running the following commands will achieve this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>user@ELKNode ~<span class="o">]</span>$ systemctl stop logstash
<span class="o">[</span>user@ELKNode ~<span class="o">]</span>$ rm /etc/logstash/conf.d/*

<span class="o">[</span>user@ELKNode ~<span class="o">]</span>$ <span class="nb">cd</span> ~
<span class="o">[</span>user@ELKNode ~<span class="o">]</span>$ git clone https://github.com/Cyb3rWard0g/HELK
<span class="o">[</span>user@ELKNode conf.d<span class="o">]</span>$ <span class="nb">cd</span> /etc/logstash/conf.d
<span class="o">[</span>user@ELKNode conf.d<span class="o">]</span>$ cp -rv ~/HELK/docker/helk-logstash/pipeline/* .

<span class="o">[</span>user@ELKNode conf.d<span class="o">]</span>$ mkdir -p /usr/share/logstash/pipeline/ruby
<span class="o">[</span>user@ELKNode conf.d<span class="o">]</span>$ cp -v ruby/ip_clean_and_public.rb /usr/share/logstash/pipeline/ruby/
<span class="o">[</span>user@ELKNode conf.d<span class="o">]</span>$ cp -v ruby/community-id.rb /usr/share/logstash/pipeline/ruby/

<span class="o">[</span>user@ELKNode conf.d<span class="o">]</span>$ sed -i <span class="s1">&#39;s/helk-elasticsearch/10.0.0.10/g&#39;</span> *.conf
<span class="o">[</span>user@ELKNode conf.d<span class="o">]</span>$ rm 0002-kafka-input.conf

<span class="o">[</span>user@ELKNode conf.d<span class="o">]</span>$ systemctl start logstash
</code></pre></td></tr></table>
</div>
</div><h2 id="shipping-logs-with-winlogbeat">Shipping Logs with WinlogBeat</h2>
<p>Winlogbeat is the Beat that will be used to ship logs from a Windows endpoint to Logstash. Make sure to downlaod the Winlogbeat zip file from the offical website, extract it to a location on the disk. I usually put it into <code>C:\Program Files</code>, however, you may choose to use a different directory.</p>
<p>Next the Winlogbeat configuration file must be setup properly. The location of this configuration file is <code>C:\Program Files\winlogbeat-7.3.2-windows-x86_64\winlogbeat.yml</code>. The following shows a base configuration that can be used which will ship logs from Application, System, Security, and <code>Microsoft-Windows-Sysmon/Operational</code>. The destination location is Logstash located at 10.0.0.10:5044.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="k">winlogbeat.event_logs</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>Application<span class="w">
</span><span class="w">    </span><span class="k">ignore_older</span><span class="p">:</span><span class="w"> </span>30m<span class="w">
</span><span class="w">  </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>Security<span class="w">
</span><span class="w">    </span><span class="k">ignore_older</span><span class="p">:</span><span class="w"> </span>30m<span class="w">
</span><span class="w">  </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>System<span class="w">
</span><span class="w">    </span><span class="k">ignore_older</span><span class="p">:</span><span class="w"> </span>30m<span class="w">
</span><span class="w">  </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>Microsoft-windows-sysmon/operational<span class="w">
</span><span class="w">    </span><span class="k">ignore_older</span><span class="p">:</span><span class="w"> </span>30m<span class="w">
</span><span class="w">  </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>Microsoft-windows-PowerShell/Operational<span class="w">
</span><span class="w">    </span><span class="k">ignore_older</span><span class="p">:</span><span class="w"> </span>30m<span class="w">
</span><span class="w">    </span><span class="k">event_id</span><span class="p">:</span><span class="w"> </span><span class="m">4103</span><span class="p">,</span><span class="w"> </span><span class="m">4104</span><span class="w">
</span><span class="w">  </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>Windows<span class="w"> </span>PowerShell<span class="w">
</span><span class="w">    </span><span class="k">event_id</span><span class="p">:</span><span class="w"> </span><span class="m">400</span><span class="p">,</span><span class="m">600</span><span class="w">
</span><span class="w">    </span><span class="k">ignore_older</span><span class="p">:</span><span class="w"> </span>30m<span class="w">
</span><span class="w"></span><span class="k">setup.template.settings</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="k">index.number_of_shards</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span><span class="w"></span><span class="k">output.logstash</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="k">hosts</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;10.0.0.10:5044&#34;</span><span class="p">]</span><span class="w">
</span><span class="w"></span><span class="k">processors</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="k">add_host_metadata</span><span class="p">:</span><span class="w"> </span>~<span class="w">
</span><span class="w">  </span>- <span class="k">add_cloud_metadata</span><span class="p">:</span><span class="w"> </span>~<span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>After the configuration file is altered the service can be installed by running the following Powershell script, it is located in the same directory as the configuration file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="n">C:</span><span class="p">\</span><span class="n">Program</span> <span class="n">Files</span><span class="p">\</span><span class="n">winlogbeat</span><span class="p">-</span><span class="n">7</span><span class="p">.</span><span class="n">4</span><span class="p">.</span><span class="n">2-windows-x86_64</span><span class="p">&gt;</span><span class="n">powershell</span> <span class="n">-ExecutionPolicy</span> <span class="n">ByPass</span>
<span class="n">Windows</span> <span class="n">PowerShell</span>
<span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="n">Microsoft</span> <span class="n">Corporation</span><span class="p">.</span> <span class="n">All</span> <span class="n">rights</span> <span class="n">reserved</span><span class="p">.</span>

<span class="nb">PS </span><span class="n">C:</span><span class="p">\</span><span class="n">Program</span> <span class="n">Files</span><span class="p">\</span><span class="n">winlogbeat</span><span class="p">-</span><span class="n">7</span><span class="p">.</span><span class="n">4</span><span class="p">.</span><span class="n">2-windows-x86_64</span><span class="p">&gt;</span> <span class="p">.\</span><span class="nb">install-service</span><span class="n">-winlogbeat</span><span class="p">.</span><span class="n">ps1</span>

<span class="n">Status</span>   <span class="n">Name</span>               <span class="n">DisplayName</span>
<span class="p">------</span>   <span class="p">----</span>               <span class="p">-----------</span>
<span class="n">Stopped</span>  <span class="n">winlogbeat</span>         <span class="n">winlogbeat</span>
</code></pre></td></tr></table>
</div>
</div><p>After the service is installed make sure to start the service, as can be seen below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="nb">Start-Service</span> <span class="n">-Name</span> <span class="n">winlogbeat</span>
<span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="nb">Get-Service</span> <span class="n">-Name</span> <span class="n">winlogbeat</span>

<span class="n">Status</span>   <span class="n">Name</span>               <span class="n">DisplayName</span>
<span class="p">------</span>   <span class="p">----</span>               <span class="p">-----------</span>
<span class="n">Running</span>  <span class="n">winlogbeat</span>         <span class="n">winlogbeat</span>
</code></pre></td></tr></table>
</div>
</div><p>After these steps have been completed you will see that Elasticsearch will have a new index with the winlogbeat suffix. You will have to add a new index pattern in Kibana in order to query this index.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/Cyb3rWard0g/HELK/blob/master/winlogbeat/winlogbeat.yml" target="_blank" rel="noopener noreffer">HELK Winlogbeat Configuration</a>
</li>
<li><a href="https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html" target="_blank" rel="noopener noreffer">FireEye – Greater Visibility Through PowerShell Logging</a>
</li>
<li><a href="http://robwillis.info/2019/10/everything-you-need-to-know-to-get-started-logging-powershell/" target="_blank" rel="noopener noreffer">Everything You Need To Know To Get Started Logging PowerShell</a>
</li>
<li><a href="https://cyberwardog.blogspot.com/2017/06/enabling-enhanced-ps-logging-shipping.html" target="_blank" rel="noopener noreffer">Enabling Enhanced PowerShell logging &amp; Shipping Logs to an ELK Stack for Threat Hunting</a>
</li>
<li><a href="https://malwarenailed.blogspot.com/2017/09/enhanced-powershell-logging-and-sysmon.html" target="_blank" rel="noopener noreffer">Enhanced PowerShell Logging and Sysmon Logs to ElasticSearch and Visualization/Dashboarding using Kibana – Part 1 of Series</a>
</li>
<li><a href="https://www.lepide.com/how-to/enable-active-directory-security-auditing.html" target="_blank" rel="noopener noreffer">How to Enable the Security Auditing of Active Directory</a>
</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>The article was updated on 2020-01-20</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://blog.thinkbox.dev/posts/0013-monitor-windows-endpoint/" data-title="Monitoring Windows Endpoints with Winlogbeat" data-via="iiamaleks" data-hashtags="ELK"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://blog.thinkbox.dev/posts/0013-monitor-windows-endpoint/" data-hashtag="ELK"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://blog.thinkbox.dev/posts/0013-monitor-windows-endpoint/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="https://blog.thinkbox.dev/posts/0013-monitor-windows-endpoint/" data-title="Monitoring Windows Endpoints with Winlogbeat" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://blog.thinkbox.dev/posts/0013-monitor-windows-endpoint/" data-title="Monitoring Windows Endpoints with Winlogbeat"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://blog.thinkbox.dev/posts/0013-monitor-windows-endpoint/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Share on VK" data-sharer="vk" data-url="https://blog.thinkbox.dev/posts/0013-monitor-windows-endpoint/" data-title="Monitoring Windows Endpoints with Winlogbeat"><i class="fab fa-vk fa-fw"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://blog.thinkbox.dev/posts/0013-monitor-windows-endpoint/" data-title="Monitoring Windows Endpoints with Winlogbeat"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="Share on 百度" data-sharer="baidu" data-url="https://blog.thinkbox.dev/posts/0013-monitor-windows-endpoint/" data-title="Monitoring Windows Endpoints with Winlogbeat"><i class="loveit it-baidu-fill"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/elk">ELK</a></section>
        <section>
            <span><a href="javascript:window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/0012-configure-single-elk-node/" class="prev" rel="prev" title="Configuring a Single Node ELK Instance"><i class="fas fa-angle-left fa-fw"></i>Configuring a Single Node ELK Instance</a>
            <a href="/posts/0014-setting-up-wazuh/" class="next" rel="next" title="Configuring Wazuh and Kibana to Monitor Endpoints">Configuring Wazuh and Kibana to Monitor Endpoints<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div class="comment"><div id="disqus_thread"></div><noscript>
            Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript></div>
    </article></div>
            </main><footer class="footer">
    <div class="copyright"><div class="copyright-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer"><i class="far fa-heart fa-fw"></i> LoveIt</a>
        </div>

        <div class="copyright-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Aleks</a></span></div>
    </div>
</footer>
</div><a href="#" class="dynamic-to-top animated faster" id="dynamic-to-top">
            <i class="fas fa-chevron-up fa-fw"></i>
        </a><link rel="stylesheet" href="/lib/iconfont/iconfont.min.css"><script defer src="https://blog-thinkbox-dev.disqus.com/embed.js"></script><script src="/lib/smooth-scroll/smooth-scroll.polyfills.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/js/theme.min.js"></script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-161605270-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
</body>
</html>
